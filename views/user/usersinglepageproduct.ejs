<div class="font-sans">
    <div class="p-4 max-w-6xl max-md:max-w-xl mx-auto mt-8 ">
        <div class="grid items-start grid-cols-1 md:grid-cols-2 gap-6">
            <div class="sm:w-full lg:w-4/5 lg:sticky top-0 flex flex-col gap-3 ">
 
                <div class="zoom-container">
                    <img id="mainImage" src="<%= product.productImages[0] %>" alt="Imagex" class="w-full rounded-lg object-cover zoom-image min-h-96" />
                </div>


                <div class="w-full flex gap-3 overflow-x-auto">
                    <img src="<%= product.productImages[0] %>"  class="w-1/5 cursor-pointer rounded-lg thumbnail" />
                    <img src="<%= product.productImages[1] %>"  class="w-1/5 cursor-pointer rounded-lg thumbnail " />
                    <img src="<%= product.productImages[2] %>"  class="w-1/5 cursor-pointer rounded-lg thumbnail object-cover" />
                    <img src="<%= product.productImages[3] %>"  class="w-1/5 cursor-pointer rounded-lg thumbnail" />
                </div>
            </div>
                        <div class=" px-5 pb-8 sm:text-center lg:text-start rounded">
                        <h2 class="text-2xl max-sm:text-2xl text-red-900 font-bold font-serif text-black-800 pt-3"><%=product.productName%></h2>
                        <div class="mt-8">
                          <div>
                              <% if(product.productDiscount > 0) { %>
                                  <h3 class="text-black text-2xl max-sm:text-2xl font-bold inline-block">
                                      <del>Rs. <%= product.productPrice %></del>
                                      Rs. <%= product.productPrice - (product.productPrice * (product.productDiscount / 100)) %>
                                  </h3>
                                  <h4 class="text-black text-xs max-sm:text-xs font-normal">Save <%= product.productDiscount %> %</h4>
                              <% } else { %>
                                  <h3 class="text-black text-2xl max-sm:text-2xl font-bold inline-block">
                                      Rs. <%= product.productPrice %>
                                  </h3>
                              <% } %>
                          </div>
                      </div>
                      
                        <div>
                            <% if(product.productQuantity<=0){ %>
                                <h2 class="px-5">SOLD OUT</h2>
                                <p>This Item is currently out of Stock</p>
                           <% } else { %>
                                 <h3 class="px-5 py-2">Availability: In Stock</h3>
                           <% }  %>
                            <h2 class="px-5 py-2 font-light">Features</h2>
                            <li class="px-8 font-light">Type: <%= product.productType %></li>
                            <li class="px-8 font-light">Colour: <%= product.productColor %></li>

                            <div class="px-5 py-3">
                              <h2 class="inline-block">Ratings:</h2>
                              <% for(let i = 1; i <= 5; i++) { %>
                                  <% if(i <= product.ratings) { %>
                                      <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                  <% } else { %>
                                      <i class="fa-regular fa-star" style="color: rgb(247, 245, 242);"></i> <!-- empty star -->
                                  <% } %>
                              <% } %>
                          </div>

                          
                        </div>

                        <br>
                        <br>

                        <div class="flex items-center gap-4">
                         
                            <div id="cart-controls" >
                           
                               
                                <button id="add-to-cart" type="button" class="flex items-center justify-center px-8 py-4 bg-red-400 hover:bg-red-900 text-white border border-gray-800 text-base rounded-lg"
                                <% if (product.productQuantity <= 0) { %> cursor-not-allowed opacity-50 <% } %>"
                                <% if (product.productQuantity <= 0) { %> disabled <% } %>>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer fill-current inline mr-3" viewBox="0 0 512 512">
                                        <path  d="M164.96 300.004h.024c.02 0 .04-.004.059-.004H437a15.003 15.003 0 0 0 14.422-10.879l60-210a15.003 15.003 0 0 0-2.445-13.152A15.006 15.006 0 0 0 497 60H130.367l-10.722-48.254A15.003 15.003 0 0 0 105 0H15C6.715 0 0 6.715 0 15s6.715 15 15 15h77.969c1.898 8.55 51.312 230.918 54.156 243.71C131.184 280.64 120 296.536 120 315c0 24.812 20.188 45 45 45h272c8.285 0 15-6.715 15-15s-6.715-15-15-15H165c-8.27 0-15-6.73-15-15 0-8.258 6.707-14.977 14.96-14.996zM477.114 90l-51.43 180H177.032l-40-180zM150 405c0 24.813 20.188 45 45 45s45-20.188 45-45-20.188-45-45-45-45 20.188-45 45zm45-15c8.27 0 15 6.73 15 15s-6.73 15-15 15-15-6.73-15-15 6.73-15 15-15zm167 15c0 24.813 20.188 45 45 45s45-20.188 45-45-20.188-45-45-45-45 20.188-45 45zm45-15c8.27 0 15 6.73 15 15s-6.73 15-15 15-15-6.73-15-15 6.73-15 15-15zm0 0"
                                      data-original="#000000"></path>
                                    </svg>
                                    Add to cart
                                </button>
                            </div>

                             
                                <button id="wishList" type="button" class="flex items-center justify-center px-8 py-4 bg-red-400 hover:bg-red-900 text-white border border-gray-800 text-base rounded-lg">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer fill-current inline mr-3" viewBox="0 0 64 64">
                                        <path d="M45.5 4A18.53 18.53 0 0 0 32 9.86 18.5 18.5 0 0 0 0 22.5C0 40.92 29.71 59 31 59.71a2 2 0 0 0 2.06 0C34.29 59 64 40.92 64 22.5A18.52 18.52 0 0 0 45.5 4ZM32 55.64C26.83 52.34 4 36.92 4 22.5a14.5 14.5 0 0 1 26.36-8.33 2 2 0 0 0 3.27 0A14.5 14.5 0 0 1 60 22.5c0 14.41-22.83 29.83-28 33.14Z" data-original="#000000"></path>
                                    </svg>
                                    Add to wishlist
                                </button>

                            </div>
                            
                         
                    </div>
                </div>
            </div>
            <div>
                <br>
                <h3 class="text-red-900 font-semibold font-serif py-3 px-5 border-b-2 border-red-900">Description</h3>
                <ul class="text-black font-normal  font-serif text-base py-3  px-10 cursor-pointer">
                    <%= product.productDescription %></ul>
                <br>
                <hr>
                <h3 class=" font-semibold py-3 px-5">Reviews</h3>
                <hr class="w-1/12">
                <ul class="py-2 px-10">"Recently purchased a wallet via online. Well satisfied with the product delivery and the quality"</ul>
                <ul class="py-2 px-10">"Nice Product"</ul>
            </div>
            
        </div>
       
<div id="cart-modal" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center bg-black bg-opacity-50 hidden z-50">
    <div class="bg-white p-6 rounded shadow-lg w-96">
        <div class="flex justify-between items-center mb-4">
            <p id="show-message" class="text-lg font-semibold"></p>
            <button id="close-modal" class="mt-4 px-4 py-2 bg-red-400 text-white rounded hover:bg-red-600">Close</button>
        </div>
    </div>
</div>




      


<script>
    
document.getElementById('add-to-cart').addEventListener('click', function () {
    const productId = '<%= product._id %>';
 
    
    let quantity = 1; 

    fetch('/user/addtocart', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ productId: productId, productCount: quantity })  
    })
    .then(response => response.json())  
    .then(data => {
        
        console.log(data)
        const cartModal = document.getElementById('cart-modal');
        const showMessage = document.getElementById('show-message');

        if (data.message === 'Product added to cart') {
            console.log("false")
            showMessage.textContent = 'Product added to cart!';
        } else if (data.message == 'Please log in to add products to the cart') {
            console.log("true")
            showMessage.textContent = 'Please log in to continue!';
            console.log("tru")
            console.log(showMessage.textContent)
        }

        cartModal.style.display = 'block'; 
    })
    .catch(error => {
        console.error('Error:', error);  
    });
});

document.getElementById('close-modal').addEventListener('click', function () {
    document.getElementById('cart-modal').style.display = 'none';
});




            
            const thumbnails = document.querySelectorAll('.thumbnail');
            
            
            const mainImage = document.getElementById('mainImage');
          
            thumbnails.forEach(thumbnail => {
              thumbnail.addEventListener('click', function() {
            
                mainImage.src = this.src;
              });
            });


            document.getElementById('add-to-cart').addEventListener('click', function () {
    console.log('Add to cart clicked');
 
});

document.getElementById('close-modal').addEventListener('click', function () {
    console.log('Close modal clicked');
    document.getElementById('cart-modal').style.display = 'none';
});



document.getElementById('wishList').addEventListener('click', function () {
    const productId = '<%= product._id %>';
  
    console.log("sending")
 
    fetch('/user/addToWishList', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ productId: productId})  
    })
    .then(response => response.json())  
    .then(data => {
        
        console.log(data)
        const cartModal = document.getElementById('cart-modal');
        const showMessage = document.getElementById('show-message');

        if (data.message === 'Product added to WishList') {
            console.log("false")
            showMessage.textContent = 'Product added to WishList!';
        } else if (data.message == 'Please log in to add products to the WishList') {
            console.log("true")
            showMessage.textContent = 'Please log in to continue!';
            console.log("tru")
            console.log(showMessage.textContent)
        } else {
            showMessage.textContent=data.message;
        }

        cartModal.style.display = 'block';  
    })
    .catch(error => {
        console.error('Error:', error);  
    });
});

</script>

        

<style>
    .zoom-container {
      position: relative;
      overflow: hidden;
    }
    
    .zoom-image {
      transition: transform 0.3s ease; /* Smooth zoom effect */
    }
    
    .zoom-image:hover {
      transform: scale(1.5); /* Zoom factor (increase this value for more zoom) */
      cursor: zoom-in;
    }
  </style>

