<div class="font-sans">
    <div class="p-4 max-w-6xl max-md:max-w-xl mx-auto mt-8 ">
        <div class="grid items-start grid-cols-1 md:grid-cols-2 gap-6">
            <div class="sm:w-full lg:w-4/5 lg:sticky top-0 flex flex-col gap-3 ">

                <div class="zoom-container">
                    <img id="mainImage" src="<%= product.productImages[0] %>" alt="Imagex" class="w-full rounded-lg object-cover zoom-image h-80" />
                </div>

                <div class="w-full flex gap-3 overflow-x-auto">
                    <img src="<%= product.productImages[0] %>" alt="Image1" class="w-1/5 cursor-pointer rounded-lg thumbnail" />
                    <img src="<%= product.productImages[1] %>" alt="Image2" class="w-1/5 cursor-pointer rounded-lg thumbnail " />
                    <img src="<%= product.productImages[2] %>" alt="Image3" class="w-1/5 cursor-pointer rounded-lg thumbnail object-cover" />
                    <img src="<%= product.productImages[3] %>" alt="Image4" class="w-1/5 cursor-pointer rounded-lg thumbnail" />
                </div>
            </div>

            <div class="bg-red-100 px-5 pb-8 sm:text-center lg:text-start rounded">
                <h2 class="text-2xl max-sm:text-2xl font-bold font-serif text-black-800 pt-3"><%= product.productName %></h2>
                <div class="mt-8">
                    <!-- Display Price and Discount Info -->
                    <div>
                        <% if(product.productDiscount > 0) { %>
                            <h3 class="text-black text-2xl max-sm:text-2xl font-bold inline-block">
                                <del>Rs. <%= product.productPrice %></del>
                                Rs. <%= product.productPrice - (product.productPrice * (product.productDiscount / 100)) %>
                            </h3>
                            <h4 class="text-black text-xs max-sm:text-xs font-normal">Save <%= product.productDiscount %> %</h4>
                        <% } else { %>
                            <h3 class="text-black text-2xl max-sm:text-2xl font-bold inline-block">
                                Rs. <%= product.productPrice %>
                            </h3>
                        <% } %>
                    </div>
                </div>

                <!-- Availability Section -->
                <div>
                    <% if(product.productQuantity<=0){ %>
                        <h2 class="px-5">SOLD OUT</h2>
                        <p>This Item is currently out of Stock</p>
                    <% } else { %>
                        <h3 class="px-5 py-2">Availability: In Stock</h3>
                    <% }  %>

                    <h2 class="px-5 py-2 font-light">Features</h2>
                    <li class="px-8 font-light">Type: <%= product.productType %></li>
                    <li class="px-8 font-light">Colour: <%= product.productColor %></li>
                </div>

                <!-- Cart Button / Quantity Controls -->
                <div id="cart-controls" class="mt-10 flex flex-wrap gap-4 font-serif">
                    <button id="add-to-cart-btn" type="button" class="flex items-center justify-center px-8 py-4 bg-red-400 hover:bg-red-900 text-white border border-gray-800 text-base rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer fill-current inline mr-3" viewBox="0 0 512 512">
                            <path d="..." />
                        </svg>
                        Add to cart
                    </button>
                </div>

                <!-- Modal -->
                <div id="cart-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
                    <div class="bg-white rounded-lg p-6">
                        <h2 class="text-xl font-semibold">Product added to cart!</h2>
                        <button id="close-modal" class="mt-4 px-4 py-2 bg-red-400 text-white rounded">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Get the Add to Cart button and Cart Modal
    const addToCartBtn = document.getElementById('add-to-cart-btn');
    const cartModal = document.getElementById('cart-modal');
    const closeModalBtn = document.getElementById('close-modal');
    const cartControls = document.getElementById('cart-controls');

    // Event listener for Add to Cart button
    addToCartBtn.addEventListener('click', function () {
        // Show modal
        cartModal.classList.remove('hidden');
        // Replace Add to Cart button with quantity controls
        cartControls.innerHTML = `
            <div class="flex items-center gap-3">
                <button id="decrease-qty" class="px-4 py-2 bg-red-400 text-white rounded">-</button>
                <span id="qty-display" class="font-semibold">1</span>
                <button id="increase-qty" class="px-4 py-2 bg-red-400 text-white rounded">+</button>
            </div>
        `;
        // Handle Quantity Increase/Decrease
        let quantity = 1;
        const qtyDisplay = document.getElementById('qty-display');
        document.getElementById('increase-qty').addEventListener('click', function () {
            quantity++;
            qtyDisplay.innerText = quantity;
        });
        document.getElementById('decrease-qty').addEventListener('click', function () {
            if (quantity > 1) {
                quantity--;
                qtyDisplay.innerText = quantity;
            }
        });
    });

    // Event listener for Close Modal button
    closeModalBtn.addEventListener('click', function () {
        cartModal.classList.add('hidden');
    });
</script>




<div id="cart-controls" class="flex items-center gap-4">
    <!-- Add to Cart Button -->
    <button id="add-to-cart-btn" type="button" class="flex items-center justify-center px-8 py-4 bg-red-400 hover:bg-red-900 text-white border border-gray-800 text-base rounded-lg">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer fill-current inline mr-3" viewBox="0 0 512 512">
            <path d="..." />
        </svg>
        Add to cart
    </button>

    <!-- Add to Wishlist Button -->
    <button type="button" class="flex items-center justify-center px-8 py-4 bg-red-400 hover:bg-red-900 text-white border border-gray-800 text-base rounded-lg">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer fill-current inline mr-3" viewBox="0 0 64 64">
            <path d="M45.5 4A18.53 18.53 0 0 0 32 9.86 18.5 18.5 0 0 0 0 22.5C0 40.92 29.71 59 31 59.71a2 2 0 0 0 2.06 0C34.29 59 64 40.92 64 22.5A18.52 18.52 0 0 0 45.5 4ZM32 55.64C26.83 52.34 4 36.92 4 22.5a14.5 14.5 0 0 1 26.36-8.33 2 2 0 0 0 3.27 0A14.5 14.5 0 0 1 60 22.5c0 14.41-22.83 29.83-28 33.14Z" data-original="#000000"></path>
        </svg>
        Add to wishlist
    </button>
</div>
<%- if(sessionuser){ %>
<!-- Modal for Add to Cart Confirmation -->
<div id="cart-modal" class="fixed inset-0 items-center justify-center bg-black bg-opacity-50  flex hidden">
    <div class="bg-white rounded-lg text-center p-6">
        <h2 class="text-xl text-center font-semibold">Product added to cart!</h2>
        <button id="close-modal" class="mt-4 px-4 py-2 bg-red-400  text-white rounded">Close</button>
    </div>
</div>
</div>
<% }else{ %>
<a href="/user/login"></a>
<%  }   %>






<div class="flex flex-col gap-4">
    <div>
        <h3 class="text-base font-bold text-gray-800"></h3>
        <p class="text-sm font-semibold text-gray-500 mt-2 flex items-center gap-2">Color: <span class="inline-block w-5 h-5 rounded-md 
            <% if (product.productColor === 'Brown') { %> bg-red-900 
            <% } else if (product.productColor === 'Blue') { %> bg-blue-400 
            <% } else if (product.productColor === 'Green') { %> bg-green-400 
            <% } %>"  >

        </span>
        </span></p>
    </div>



    




    <div class="font-sans">
        <div class="p-4 max-w-6xl max-md:max-w-xl mx-auto mt-8 ">
            <div class="grid items-start grid-cols-1 md:grid-cols-2 gap-6">
                <div class="sm:w-full lg:w-4/5 lg:sticky top-0 flex flex-col gap-3 ">
     
                    <div class="zoom-container">
                        <img id="mainImage" src="<%= product.productImages[0] %>" alt="Imagex" class="w-full rounded-lg object-cover zoom-image h-80" />
                    </div>
    
    
                    <div class="w-full flex gap-3 overflow-x-auto">
                        <img src="<%= product.productImages[0] %>" alt="Image1" class="w-1/5 cursor-pointer rounded-lg thumbnail" />
                        <img src="<%= product.productImages[1] %>" alt="Image2" class="w-1/5 cursor-pointer rounded-lg thumbnail " />
                        <img src="<%= product.productImages[2] %>" alt="Image3" class="w-1/5 cursor-pointer rounded-lg thumbnail object-cover" />
                        <img src="<%= product.productImages[3] %>" alt="Image4" class="w-1/5 cursor-pointer rounded-lg thumbnail" />
                    </div>
                </div>
                            <div class="bg-red-100 px-5 pb-8 sm:text-center lg:text-start rounded">
                            <h2 class="text-2xl max-sm:text-2xl font-bold font-serif text-black-800 pt-3"><%=product.productName%></h2>
                            <div class="mt-8">
                              <div>
                                  <% if(product.productDiscount > 0) { %>
                                      <h3 class="text-black text-2xl max-sm:text-2xl font-bold inline-block">
                                          <del>Rs. <%= product.productPrice %></del>
                                          Rs. <%= product.productPrice - (product.productPrice * (product.productDiscount / 100)) %>
                                      </h3>
                                      <h4 class="text-black text-xs max-sm:text-xs font-normal">Save <%= product.productDiscount %> %</h4>
                                  <% } else { %>
                                      <h3 class="text-black text-2xl max-sm:text-2xl font-bold inline-block">
                                          Rs. <%= product.productPrice %>
                                      </h3>
                                  <% } %>
                              </div>
                          </div>
                          
                            <div>
                                <% if(product.productQuantity<=0){ %>
                                    <h2 class="px-5">SOLD OUT</h2>
                                    <p>This Item is currently out of Stock</p>
                               <% } else { %>
                                     <h3 class="px-5 py-2">Availability: In Stock</h3>
                               <% }  %>
                                <h2 class="px-5 py-2 font-light">Features</h2>
                                <li class="px-8 font-light">Type: <%= product.productType %></li>
                                <li class="px-8 font-light">Colour: <%= product.productColor %></li>
    
                                <div class="px-5 py-3">
                                  <h2 class="inline-block">Ratings:</h2>
                                  <% for(let i = 1; i <= 5; i++) { %>
                                      <% if(i <= product.ratings) { %>
                                          <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                                      <% } else { %>
                                          <i class="fa-regular fa-star" style="color: rgb(247, 245, 242);"></i> <!-- empty star -->
                                      <% } %>
                                  <% } %>
                              </div>
    
                              
                            </div>
    
                            <br>
                            <br>
    
                            <div class="flex items-center gap-4">
                                <!-- Cart and Wishlist Controls -->
                                <div id="cart-controls" >
                                    <!-- Add to Cart Button -->
                                     
                                    <button id="add-to-cart-btn" type="button" class="flex items-center justify-center px-8 py-4 bg-red-400 hover:bg-red-900 text-white border border-gray-800 text-base rounded-lg">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer fill-current inline mr-3" viewBox="0 0 512 512">
                                            <path d="..." />
                                        </svg>
                                        Add to cart
                                    </button>
                                </div>
                                    <!-- Add to Wishlist Button -->
                                    <button type="button" class="flex items-center justify-center px-8 py-4 bg-red-400 hover:bg-red-900 text-white border border-gray-800 text-base rounded-lg">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer fill-current inline mr-3" viewBox="0 0 64 64">
                                            <path d="M45.5 4A18.53 18.53 0 0 0 32 9.86 18.5 18.5 0 0 0 0 22.5C0 40.92 29.71 59 31 59.71a2 2 0 0 0 2.06 0C34.29 59 64 40.92 64 22.5A18.52 18.52 0 0 0 45.5 4ZM32 55.64C26.83 52.34 4 36.92 4 22.5a14.5 14.5 0 0 1 26.36-8.33 2 2 0 0 0 3.27 0A14.5 14.5 0 0 1 60 22.5c0 14.41-22.83 29.83-28 33.14Z" data-original="#000000"></path>
                                        </svg>
                                        Add to wishlist
                                    </button>
                                </div>
                                
                                <div id="cart-modal" class="fixed inset-0 items-center justify-center bg-black bg-opacity-50 flex hidden">
                                    <div class="bg-white rounded-lg text-center p-6">
                                        <% if (sessionuser) { %>
                                            <h2 class="text-xl text-center font-semibold">Product added to cart!</h2>
                                            <button id="close-modal" class="mt-4 px-4 py-2 bg-red-400 text-white rounded">Close</button>
                                        <% } else { %>
                                            <h2 class="text-xl text-center font-semibold">Please log in to add items to your cart.</h2>
                                            <a href="/user/login" class="mt-4 inline-block px-4 py-2 bg-red-400 text-white rounded hover:bg-red-900">Log in</a>
                                        <% } %>
                                        <form id="cart-form" action="/user/addtocart/product._id" method="POST" class="hidden">
                                            <input type="hidden" name="productId" value="<%= product._id %>">
                                            <input type="hidden" id="quantity-input" name="quantity" value="1">
                                        </form>
                                    </div>
                                </div>  
                        </div>
                    </div>
                </div>
                <div>
                    <br>
                    <h3 class="text-red-900 font-semibold font-serif py-3 px-5 border-b-2 border-red-900">Description</h3>
                    <ul class="text-black font-normal  font-serif text-base py-3  px-10 cursor-pointer">
                        <%= product.productDescription %></ul>
                    <br>
                    <hr>
                    <h3 class=" font-semibold py-3 px-5">Reviews</h3>
                    <hr class="w-1/12">
                    <ul class="py-2 px-10">"Recently purchased a wallet via online. Well satisfied with the product delivery and the quality"</ul>
                    <ul class="py-2 px-10">"Nice Product"</ul>
                </div>
            </div>
    
    
            <script>
                // Select all thumbnail images
                const thumbnails = document.querySelectorAll('.thumbnail');
                
                // Select the main image
                const mainImage = document.getElementById('mainImage');
                
                const addToCartBtn = document.getElementById('add-to-cart-btn');
                const cartModal = document.getElementById('cart-modal');
                const closeModalBtn = document.getElementById('close-modal');
                const cartControls = document.getElementById('cart-controls');
               
        //const qtyBox=document.getElementById('qty-box')
                // Loop through each thumbnail and add a click event listener
                thumbnails.forEach(thumbnail => {
                  thumbnail.addEventListener('click', function() {
                    // On click, set the main image source to the clicked thumbnail's source
                    mainImage.src = this.src;
                  });
                });
    
    
                addToCartBtn.addEventListener('click', function () {
            // Show modal
            cartModal.classList.remove('hidden');
            cartform.submit();
            // Replace Add to Cart button with quantity controls
            cartControls.innerHTML = `
                <div class="flex items-center gap-3">
                    <h2>Qty</h2>
                    <button id="decrease-qty" class="px-4 py-2 bg-red-400 text-white rounded">-</button>
                    <span id="qty-display" class="font-semibold">1</span>
                    <button id="increase-qty" class="px-4 py-2 bg-red-400 text-white rounded">+</button>
                </div>
            `;
            
            // Handle Quantity Increase/Decrease
            let quantity = 1;
            const qtyDisplay = document.getElementById('qty-display');
            document.getElementById('increase-qty').addEventListener('click', function () {
                quantity++;
                qtyDisplay.innerText = quantity;
            });
            document.getElementById('decrease-qty').addEventListener('click', function () {
                if (quantity > 1) {
                    quantity--;
                    qtyDisplay.innerText = quantity;
                }
            });
        });
    
        // Event listener for Close Modal button
        closeModalBtn.addEventListener('click', function () {
            cartModal.classList.add('hidden');
            qtyBox.style.display='inline'
        });
    
              </script>
    
    <style>
        .zoom-container {
          position: relative;
          overflow: hidden;
        }
        
        .zoom-image {
          transition: transform 0.3s ease; /* Smooth zoom effect */
        }
        
        .zoom-image:hover {
          transform: scale(1.5); /* Zoom factor (increase this value for more zoom) */
          cursor: zoom-in;
        }
      </style>
    
    <!-- <style>
        .zoom-container {
          position: relative;
          overflow: hidden;
        }
        
        .zoom-image {
          transition: transform 0.5s ease;
        }
        
        .zoom-container.zoomed .zoom-image {
          transform: scale(2); /* Adjust scale as needed */
        }
      </style> -->
    





